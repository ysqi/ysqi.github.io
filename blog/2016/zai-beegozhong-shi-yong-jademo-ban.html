<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>在Beego中使用Jade模板 - 虞双齐的博客</title><link rel="alternate" hreflang="zh" href="https://yushuangqi.com"><meta name="renderer" content="webkit"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="MobileOptimized" content="width"><meta name="HandheldFriendly" content="true"><meta name="applicable-device" content="pc,mobile"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="theme-color" content="#f8f5ec"><meta name="msapplication-navbutton-color" content="#f8f5ec"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec"><meta name="mobile-web-app-capable" content="yes"><meta name="author" content="虞双齐"><meta name="description" content="Jade是一个高性能的HTML模板引擎，它受到Haml的影响,是使用JavaScript实现的。Jade在客户端也有支持，它的代码比html"><meta name="keywords" content="智能合约开发, Go语言, 区块链技术"><meta name="generator" content="Hugo 0.37.1"><link rel="canonical" href="https://yushuangqi.com/blog/2016/zai-beegozhong-shi-yong-jademo-ban.html"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" href="/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link href="/dist/jane.min.css?v=2.7.0" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous"><meta property="og:title" content="在Beego中使用Jade模板"><meta property="og:description" content="Jade是一个高性能的HTML模板引擎，它受到Haml的影响,是使用JavaScript实现的。Jade在客户端也有支持，它的代码比html"><meta property="og:type" content="article"><meta property="og:url" content="https://yushuangqi.com/blog/2016/zai-beegozhong-shi-yong-jademo-ban.html"><meta property="article:published_time" content="2016-12-31T11:32:52&#43;08:00"><meta property="article:modified_time" content="2016-12-31T11:32:52&#43;08:00"><meta itemprop="name" content="在Beego中使用Jade模板"><meta itemprop="description" content="Jade是一个高性能的HTML模板引擎，它受到Haml的影响,是使用JavaScript实现的。Jade在客户端也有支持，它的代码比html"><meta itemprop="datePublished" content="2016-12-31T11:32:52&#43;08:00"><meta itemprop="dateModified" content="2016-12-31T11:32:52&#43;08:00"><meta itemprop="wordCount" content="2117"><meta itemprop="keywords" content="jade,golang,beego,"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="在Beego中使用Jade模板"><meta name="twitter:description" content="Jade是一个高性能的HTML模板引擎，它受到Haml的影响,是使用JavaScript实现的。Jade在客户端也有支持，它的代码比html"><!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]--><!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]--></head><body><div id="mobile-navbar" class="mobile-navbar"><div class="mobile-header-logo"><a href="/" class="logo">虞双齐的博客</a></div><div class="mobile-navbar-icon"><span></span> <span></span> <span></span></div></div><nav id="mobile-menu" class="mobile-menu slideout-menu"><ul class="mobile-menu-list"><a href="/"><li class="mobile-menu-item">首页</li></a><a href="/series.html"><li class="mobile-menu-item">专题</li></a><a href="/categories.html"><li class="mobile-menu-item">分类</li></a><a href="/tags.html"><li class="mobile-menu-item">标签</li></a><a href="/post.html"><li class="mobile-menu-item">归档</li></a><a href="/about.html"><li class="mobile-menu-item">关于</li></a></ul></nav><header id="header" class="header container"><div class="logo-wrapper"><a href="/" class="logo">虞双齐的博客</a></div><nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item"><a class="menu-item-link" href="/">首页</a></li><li class="menu-item"><a class="menu-item-link" href="/series.html">专题</a></li><li class="menu-item"><a class="menu-item-link" href="/categories.html">分类</a></li><li class="menu-item"><a class="menu-item-link" href="/tags.html">标签</a></li><li class="menu-item"><a class="menu-item-link" href="/post.html">归档</a></li><li class="menu-item"><a class="menu-item-link" href="/about.html">关于</a></li></ul></nav></header><div id="mobile-panel"><main id="main" class="main bg-llight"><div class="content-wrapper"><div id="content" class="content container"><article class="post bg-white"><header class="post-header"><h1 class="post-title">在Beego中使用Jade模板</h1><div class="post-meta"><span class="post-time">2016-12-31</span><div class="post-category"><a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E4%B8%8E%E5%BC%80%E5%8F%91.html">编程语言与开发</a></div><span class="more-meta">约 2117 字 </span><span class="more-meta">预计阅读 5 分钟</span></div></header><div class="post-toc" id="post-toc"><h2 class="post-toc-title">文章目录</h2><div class="post-toc-content always-active"><nav id="TableOfContents"><ul><li><ul><li><a href="#html-template">html/template</a></li><li><a href="#addtemplateengine">AddTemplateEngine</a></li><li><a href="#jade-go">jade.go</a></li><li><a href="#jade模板的使用">jade模板的使用</a></li><li><a href="#ace">ace</a></li></ul></li></ul></nav></div></div><div class="post-content"><p><a href="https://pugjs.org/api/getting-started.html">Jade</a>是一个高性能的HTML模板引擎，它受到<a href="http://haml-lang.com/">Haml</a>的影响,是使用JavaScript实现的。Jade在客户端也有支持，它的代码比html可读性要高很多，Jade是一个比较常用的HTML模板。<br><a href="https://beego.me/">Beego</a>是一个go语言的web应用程序开源web框架，而Beego从1.7.0开始支持更加复杂的模板引擎，当然也包括了对于jade的支持，支持更复杂模板引擎的PR地址<a href="https://github.com/astaxie/beego/pull/1940">https://github.com/astaxie/beego/pull/1940</a>。<br>在介绍Jade的使用之前先来看下Go下面的<code>html/template</code>包。</p><h2 id="html-template">html/template</h2><p>在Go语言中，<code>html/template</code>包是一个很强大的html模板包，结合<code>text/template</code>的模板语法，基本上可以满足大部分的HTML模板需求，无论是Beego中是默认支持的两种模板格式<code>.tpl</code>和<code>.html</code>,以及<code>jade</code>和<code>ace</code>都是可以解析为<code>html/template</code>中的Template对象使用，就是说我们所使用的html模板最终都是基于<code>html/template</code>包实现的。<br><code>html/template</code>使用实例:</p><pre><code>package main
import (
    &quot;html/template&quot;
)
type User struct {
    Name string
}
func main() {
    t := template.New(&quot;template example&quot;)
    t, _ = t.Parse(&quot;hello {{.Name}}!&quot;)
    p := User{Name: &quot;jjz&quot;}
    t.Execute(os.Stdout, p)
}
</code></pre><p>上面的例子会输出字符串：<code>hello jjz</code>。<br>通过上面的例子我们可以看到，如何新建一个模板，再使用模板函数<code>Parse()</code>从字符串中加载模板内容，使用模板函数<code>Execute()</code>可以给模板替换字段。替换模板字段的语法,<code>{{}}</code>中的字段就是要替换字段,<code>{{. Name}}</code>表示需要替换的字段名称。<br><code>Beego</code>使用复杂模板的方式很简单，增加一个模板引擎函数，在项目运行的时候遍历<code>views</code>中的文件，把指定的文件解析为<code>template.Template</code>对象，返回该对象提供使用，这个模板引擎函数就是：`beego.AddTemplateEngine<br>`。</p><h2 id="addtemplateengine">AddTemplateEngine</h2><p><code>beego.AddTemplateEngine</code>是一个用来把指定的文件，转换为<code>template.Template</code>的对象的函数。它的第一个参数是文件的后缀名，在<code>views</code>中的含有此后缀名的文件都会进入该方法进行处理。他的第二个参数是一个函数，用来处理文件的转换，最后会返回一个<code>template.Template</code>的对象。有了这个函数，我们还少一个把jade文件解析为<code>template.Template</code>的方法，还好有人已经做了jade的Go语言实现。</p><h2 id="jade-go">jade.go</h2><p><a href="https://github.com/Joker/jade">jade.go</a>是Jade的Go语言实现。<br><code>jade.go</code>的使用，首先安装jade.go：</p><blockquote><p>go get github.com/Joker/jade</p></blockquote><p><code>jade.go</code>使用示例:</p><pre><code>func main() {
    tpl, err := jade.Parse(&quot;name_of_tpl&quot;, &quot;doctype 5: html: body: p Hello world!&quot;)
    if err != nil {
        return
    }
    fmt.Printf( &quot;%s&quot;, tpl  )
}
</code></pre><p>输出字符串:</p><pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;body&gt;
        &lt;p&gt;Hello world!&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>有了<code>jade.go</code>就可以在Beego中使用，把jade文件转换为Template对象，在beego中添加<code>jade.go</code>解析jade模板的方法：</p><pre><code>func addJadeTemplate() {
    beego.AddTemplateEngine(&quot;jade&quot;, func(root, path string, funcs template.FuncMap) (*template.Template, error) {
        jadePath := filepath.Join(root, path)
        content, err := utils.ReadFile(jadePath)
        fmt.Println(content)
        if err != nil {
            return nil, fmt.Errorf(&quot;error loading jade template: %v&quot;, err)
        }
        tpl, err := jade.Parse(&quot;name_of_tpl&quot;, content)
        if err != nil {
            return nil, fmt.Errorf(&quot;error loading jade template: %v&quot;, err)
        }
        fmt.Println(&quot;html:\n%s&quot;,tpl)
        tmp := template.New(&quot;Person template&quot;)
        tmp, err = tmp.Parse(tpl)
        if err != nil {
            return nil, fmt.Errorf(&quot;error loading jade template: %v&quot;, err)
        }
        fmt.Println(tmp)
        return tmp, err

    })
}
</code></pre><p><code>jade.go</code>目前只支持使用字符串的方式接卸jade模板，因此需要先把.jade文件的内容以字符串的方式读取出来。读取文件的方法:</p><pre><code>func ReadFile(path string) (str string, err error) {
    fi, err := os.Open(path)
    defer fi.Close()
    fd, err := ioutil.ReadAll(fi)
    str = string(fd)
    return
}
</code></pre><p>jade.go解析出的结果也是一个字符串，因此在代码中需要把字符串转换为<code>template.Template</code>对象，使用了<code>Template.Parse()</code>方法。<br>解析jade模板的引擎方法需要在<code>main()</code>中调用，添加完jade的模板转换引擎之后，就可以在<code>Beego</code>中使用jade模板了。</p><h2 id="jade模板的使用">jade模板的使用</h2><p>首先定义一个页面<code>home.jade</code>:</p><pre><code>doctype html
html
  head
    title pageTitle
  body
    h1 jade
    .content {{.content}}
</code></pre><p>其中<code>{{.content}}</code>是需要替换的字段，<code>Controller</code>层代码：</p><pre><code>func (c *MainController) Jade() {
    c.Data[&quot;content&quot;] = &quot;this is jade template&quot;
    c.TplName = &quot;home.jade&quot;
}
</code></pre><p>运行之后生成的页面代码：</p><pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
        &lt;title&gt;pageTitle&lt;/title&gt;
     &lt;/head&gt;
      &lt;body&gt;
        &lt;h1&gt;jade&lt;/h1&gt;
        &lt;div class=&quot;content&quot;&gt;this is jade template&lt;/div&gt;  
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>通过添加一个解析模板的引擎就可以在beego中使用jade的模板，beego从1.7.0之后开始支持复杂的模板引擎，不仅仅是对于jade的支持，也包括对于其他模板引擎的支持。<br>除了jade之外，在这个PR中推荐使用的是<a href="https://github.com/yosssi/ace">ace</a>HTML模板引擎。</p><h2 id="ace">ace</h2><p><a href="https://github.com/yosssi/ace">ace</a>是一个Go语言的HTML模板引擎，它借鉴了<a href="http://slim-lang.com/">Slim</a>和<a href="https://pugjs.org/api/getting-started.html">Jade</a>,在Go语言里有超高的人气。<br><code>ace模板</code>在beego中的使用与使用<code>Jade</code>类似，首先安装<code>ace</code>的依赖包:</p><blockquote><p>go get github.com/yosssi/ace</p></blockquote><p>在main函数中添加ace模板解析引擎:</p><pre><code>func addAceTemplate()  {
    beego.AddTemplateEngine(&quot;ace&quot;, func(root, path string, funcs template.FuncMap) (*template.Template, error) {
        aceOptions := &amp;ace.Options{DynamicReload: true, FuncMap: funcs}
        aceBasePath := filepath.Join(root, &quot;base&quot;)
        aceInnerPath := filepath.Join(root, strings.TrimSuffix(path, &quot;.ace&quot;))
        tpl, err := ace.Load(aceBasePath, aceInnerPath, aceOptions)
        if err != nil {
            return nil, fmt.Errorf(&quot;error loading ace template: %v&quot;, err)
        }
        return tpl, nil
    })    
}
</code></pre><p>注意使用ace模板需要指定一个<code>base.ace</code>，另外使用<code>ace.Load()</code>函数可以直接返回一个<code>template.Template</code>对象，不需要再做其他转换的工作。<br>添加完模板引擎之后就可以直接在views中添加.ace文件使用，新建一个<code>home.ace</code>文件:</p><pre><code>= doctype html
html lang=en
  head
    meta charset=utf-8
    title Base and Inner Template
  body
    h1 ace
    .content {{.content}}
</code></pre><p>同样的{{.content}}是也需要在<code>controller</code>层本替换成需要的内容,controller层代码:</p><pre><code>func (c *MainController)Ace() {
    c.Data[&quot;content&quot;] = &quot;this is ace template&quot;
    c.TplName = &quot;home.ace&quot;
}
</code></pre><p>示例代码地址：<a href="https://github.com/jjz/go/tree/master/template">https://github.com/jjz/go/tree/master/template</a></p></div><div style="height:130px"><div class="post-copyright" style="float:left"><p class="copyright-item"><span class="item-title">文章作者</span> <span class="item-content">虞双齐</span></p><p class="copyright-item"><span class="item-title">上次更新</span> <span class="item-content">2016-12-31</span></p><p class="copyright-item"><span class="item-title">许可协议</span> <span class="item-content"><a target="_blank" rel="license noopener external nofollow" href="https://creativecommons.org/licenses/by/4.0/deed.zh">署名 4.0 国际</a></span></p></div><div class="post-copyright" style="float:right"><a href="https://info.flagcounter.com/8B1z" target="_blank" rel="noopener external nofollow"><img src="https://s05.flagcounter.com/countxl/8B1z/bg_FFFFFF/txt_000000/border_CCCCCC/columns_4/maxflags_12/viewers_0/labels_0/pageviews_1/flags_0/percent_0/" alt="Flag Counter" border="0"></a></div></div><div class="post-reward"><input type="checkbox" name="reward" id="reward" hidden> <label class="reward-button" for="reward">赞赏支持</label><div class="qr-code"><label class="qr-code-image" for="reward"><img class="image" src="/img/donateMe_wechat.png"> <span>微信打赏</span></label></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/jade.html">jade</a> <a href="/tags/golang.html">golang</a> <a href="/tags/beego.html">beego</a></div><nav class="post-nav"><a class="prev" href="/blog/2016/shi-yong-contextshi-xian-duo-ge-goroutinede-yi-lai-guan-li.html"><i class="iconfont icon-left"></i> <span class="prev-text nav-default">使用context实现多个goroutine的依赖管理</span> <span class="prev-text nav-mobile">上一篇</span> </a><a class="next" href="/blog/2016/bian-xie-ke-ce-shi-de-godai-ma.html"><span class="next-text nav-default">编写可测试的Go代码</span> <span class="prev-text nav-mobile">下一篇</span> <i class="iconfont icon-right"></i></a></nav></footer><div class="disqus-button" id="load_disqus" onclick="load_disqus()">显示 Disqus 评论</div><div id="disqus_thread"></div><script type="text/javascript">function load_disqus() {
        
        
        if (window.location.hostname === 'localhost') return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'yushuangqi';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

        $('#load_disqus').remove();
    };</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></article></div></div></main><footer id="footer" class="footer"><div class="social-links"><a href="mailto:ysqi@yushuangqi.com" rel="me" class="iconfont icon-email" title="email"></a> <a href="http://github.com/ysqi" rel="me" class="iconfont icon-github" title="github"></a> <a href="https://weibo.com/234665601" rel="me" class="iconfont icon-weibo" title="weibo"></a> <a href="https://www.zhihu.com/people/_ysqi/" rel="me" class="iconfont icon-zhihu" title="zhihu"></a> <a href="https://yushuangqi.com/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a></div><div class="copyright"><span class="power-by">Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a> </span><span class="division">|</span> <span class="theme-info">Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a> </span><span class="copyright-year">&copy; 2014 - 2021 <span class="heart"><i class="iconfont icon-heart"></i> </span><span class="author">虞双齐 | <a href="https://beian.miit.gov.cn/">粤ICP备14032560号</a></span></span></div></footer><div class="back-to-top" id="back-to-top"><i class="iconfont icon-up"></i></div></div><script src="/lib/highlight/highlight.pack.js?v=20171001"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script><script type="text/javascript" src="/dist/jane.min.js?v=2.7.0"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { fonts: ["TeX"] }
  });</script><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script><script id="baidu_analytics">var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?a16b3275b071ec0efc507a05422a7156";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();</script></body></html>